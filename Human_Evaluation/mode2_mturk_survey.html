<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FollowupQG Data Annotation Task</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html,
        body {
            height: 140%;
            font-family: Arial, sans-serif;
            background-color: #f0f2f5;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 20px;
        }

        .container {
            display: flex;
            width: 100%;
            max-width: 1200px;
            gap: 20px;
        }

        .section {
            background-color: #ffffff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .sub-section {
            background-color: #e8f4fd;
            border: 1px solid #a0c4ff;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .sub-section h2 {
            margin-bottom: 15px;
            color: #00509e;
        }

        .sub-section p {
            margin-bottom: 10px;
            color: #333;
            line-height: 1.6;
        }

        .sub-section ul {
            list-style-type: disc;
            margin-left: 20px;
            margin-bottom: 10px;
        }

        .sub-section ul li {
            margin-bottom: 8px;
            color: #333;
        }

        .sub-section-examples {
            background-color: #ffffff;
            border: 1px solid #a0c4ff;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .instructions {
            text-align: center;
        }

        .examples {
            background-color: #dcedfa;
            border: 1px solid #a0c4ff;
        }

        .character-input-container {
            flex: 1;
        }

        .crowd-form {
            flex: 1.5;
        }

        .story-container {
            flex: 1.2;
        }

        .example-story-container {
            flex: 0.5;
        }

        .example-button-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            /* Space between buttons */
            padding: 10px;
        }

        .example-buttons {
            background-color: #4CAF50;
            /* Green background */
            color: white;
            /* White text */
            padding: 15px 32px;
            /* Larger padding for better click area */
            font-size: 16px;
            /* Larger text */
            border: none;
            /* Remove default border */
            border-radius: 8px;
            /* Rounded corners */
            cursor: pointer;
            /* Show pointer cursor on hover */
            transition: background-color 0.3s;
            /* Smooth transition on hover */
        }

        .example-buttons:hover {
            background-color: #45a049;
        }

        .example-buttons.selected {
            background-color: #FF9800;
            /* Orange color for selected buttons */
            color: white;
            /* Keep the text white */
            transform: scale(1.05);
            /* Slightly enlarge the selected button for emphasis */
        }

        .section h2,
        .section h3 {
            margin-bottom: 20px;
            color: #333;
        }

        .existing-characters {
            margin-bottom: 20px;
        }

        .existing-characters label {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            cursor: pointer;
            color: #555;
        }

        .existing-characters input[type="checkbox"] {
            margin-right: 10px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .question-block {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }

        .question-block h4 {
            margin-bottom: 15px;
            color: #333;
            font-size: 16px;
        }

        .ratings-section {
            margin-top: 15px;
        }

        .ratings-section h5 {
            margin-bottom: 10px;
            color: #333;
            font-size: 14px;
        }

        .ratings-section .rating-group {
            margin-bottom: 15px;
        }

        .ratings-section label {
            margin-right: 15px;
            color: #555;
            cursor: pointer;
        }

        .ratings-section input[type="radio"] {
            margin-right: 5px;
            cursor: pointer;
        }

        .navigation-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .navigation-buttons button {
            background-color: #4CAF50;
            color: #fff;
            padding: 12px 24px;
            font-size: 16px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .navigation-buttons button:hover {
            background-color: #45a049;
            transform: translateY(-2px);
        }

        .navigation-buttons button:active {
            background-color: #3e8e41;
            transform: translateY(0);
        }

        .navigation-buttons button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            box-shadow: none;
        }

        .story-container h3 {
            margin-bottom: 20px;
            color: #333;
        }

        .story-container p {
            margin-bottom: 15px;
            line-height: 1.6;
            color: #444;
        }

        .story-container .highlighted {
            background-color: #fff9c4;
            padding: 5px;
            border-radius: 4px;
        }

        .full-body {
            display: flex;
            flex-direction: column;
            padding-left: 10vw;
            padding-right: 10vw;
        }

        .progress-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 25px;
            margin-bottom: 20px;
            overflow: hidden;
            height: 20px;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background-color: #4CAF50;
            transition: width 0.3s ease;
        }

        .validation-message {
            color: red;
            margin-top: 10px;
            font-size: 14px;
        }

        /* Hide remaining questions by default */
        .remaining-questions {
            display: none;
        }

        @media (max-width: 1200px) {
            .container {
                flex-direction: column;
                align-items: stretch;
            }

            .section {
                height: auto;
            }
        }
    </style>
</head>

<body>
    <div class="full-body">
        <div class="section">
            <div class="sub-section">
                <div class="instructions">
                    <h2>Instructions</h2>
                    <h3>Job Description</h3>
                    <p>The aim of this data annotation task is to select high-quality (Knowledge Goal Question, answer,
                        follow-up question) tuples from online forums. The raw data was collected from the Reddit forum
                        <strong>“explainlikeimfive”</strong>, which aims to provide simple, layperson-friendly
                        explanations for real-life questions.
                    </p>
                    <p>We gathered (question, answer) pairs from this forum, along with replies to those answers. Often,
                        these replies include follow-up questions. For this task, we selected follow-up questions and
                        formatted each data entry as a triple of (initial question, answer, follow-up question). </p>
                    <br>
                    <p>Our data contains some noise, such as invalid follow-up questions, sensitive information, or
                        questions unrelated to the original question or answer. Your role is to help us identify and
                        remove these noisy samples.</p>
                    <p>For each HIT, you will be shown one triple (question, answer, follow-up question). Carefully
                        review each component and answer the following questions based on your judgment:</p>
                    <div
                        style="background-color: #d8ebf5; padding: 15px; border-radius: 8px; margin-top: 15px; margin-left: 100px; margin-right: 100px">
                        <h4>Questions:</h4>
                        <ol style="text-align: left; display: inline-block; margin: 0; padding-left: 20px;">
                            <li><strong>Q1:</strong> Do you think the follow-up question is a valid question?<br>
                                <br><strong>A:</strong> Yes <strong>B:</strong> No
                            </li>
                            <br>
                            <li><strong>Q2:</strong> Do you think the (initial question, answer, follow-up question)
                                contains sensitive information?<br>
                                <br><strong>A:</strong> Yes <strong>B:</strong> No
                            </li>
                            <br>
                            <li><strong>Q3:</strong> Do you think the follow-up question is related to the original
                                question and the answer?<br>
                                <br><strong>A:</strong> Strongly Related <strong>B:</strong> Related <strong>C:</strong>
                                Slightly Related <strong>D:</strong> Not Related
                            </li>
                        </ol>
                    </div>
                    <br>
                    <h4 style="color: red;">After answering all questions for a single task, click next to move to the
                        next sample. <br>Once you complete all tasks, press submit to complete the survey.</h4>
                    <br>
                </div>
                <div class="examples">
                    <div style="display: flex; width: 100%;">
                        <div class="example-button-container"
                            style="width: 30%; border: 1px solid #a0c4ff; padding: 20px;">
                            <h4 style="text-align: center;">Follow-up Question That Are...</h4>
                            <hr>
                            <button class="example-buttons" onclick="changeContent('valid_invalid_example', this)">[Q1]
                                Valid / Invalid
                            </button>
                            <button class="example-buttons"
                                onclick="changeContent('relevant_irrelevant_example', this)">[Q2] Relevant / Irrelevant
                            </button>
                            <br>
                            <h4 style="text-align: center;">Follow-up Question That Have...</h4>
                            <hr>
                            <button class="example-buttons" onclick="changeContent('errors_example', this)">[Q3] Errors
                            </button>
                            <button class="example-buttons" onclick="changeContent('reasoning_example', this)">[Q3]
                                Reasoning
                            </button>
                            <button class="example-buttons"
                                onclick="changeContent('new_information_example', this)">[Q5] New Information
                            </button>
                        </div>
                        <div id="right-section" style="width: 70%; border: 1px solid #a0c4ff; padding: 20px;">
                            <h2 style="text-align: center;">Select from one of the options on the left to view its
                                example</h2>
                        </div>
                    </div>
                </div>
            </div>

            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>

            <div class="section">
                <div class="container">
                    <div class="section story-container">
                        <h2 style="text-align:center">Data to Annotate</h2>
                        <div id="data_container">
                        </div>
                    </div>
                    <crowd-form class="section crowd-form">
                        <div class="form-container">
                            <h2 style="text-align:center">Data Annotation Questions</h2>
                            <div id="annotation-questions-container">
                            </div>
                        </div>

                        <div class="navigation-buttons">
                            <!--<button id="prev-btn" type="button" disabled>Previous</button>-->
                            <button id="next-btn" type="button">Next</button>
                        </div>
                        <crowd-button id="crowd-button" form-action="submit" disabled=true
                            style="background-color: green;">
                            Submit
                        </crowd-button>
                    </crowd-form>
                </div>
            </div>

            <div class="validation-message" id="validation-message" style="display: none;">
                Please select at least one character and complete all associated questions to proceed.
            </div>
        </div>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="https://assets.crowd.aws/crowd-html-elements.js"></script>

        <script>
            const examples = {
                valid_invalid_example: `
                    <div style="text-align: center;">
                        <h3>Valid/Invalid Question Guideline</h3>
                        <h4>Our Question: </h4><p>Do you think the follow-up question is a valid
                        question?</p>
                        <h4>Your Options:</h4> <p>A. Yes B. No</p>
                        <p>Guideline: The follow-up question might contain
                        multiple sentences but it should consist of at least
                        one valid question. A valid question must be in
                        question format and ask meaningful information,
                        including Wh-questions (what/why/where/etc.),
                        open-ended questions, probing questions and etc.
                        Examples for invalid questions: “10000 meters?
                        really?”, which are often used in conversational
                        speech to express feelings instead of asking new
                        information.</p>
                    </div>

                    <hr>
                    <br>

                    <h3 style="text-align: center;">Valid Follow-up Questions Example #1</h3>
                    <h4><b>Initial Question:</b></h4>
                    <p>ELI5: Why is the sea calm in the mornings?</p>
                    <h4><b>Initial Answer:</b></h4>
                    <p>There are two types of waves which can turn a flat sea into a rougher one - swell waves and wind waves. Swell waves can arrive at any time of day, but because wind waves are generated by the wind, they only develop when the wind begins to blow steadily. Since wind speeds are often low at night, and increase during the daytime, wind waves often die out during the night, leading to a relatively flat sea (perhaps with swell waves) in the early morning. During the day, the wind waves increase in size as the wind speed increases, leading to a rougher, more choppy, sea surface during the afternoon and evening.</p>
                    <h4><b>Follow-up Question:</b></h4>
                    <p>Now it’s time for my question. Why are winds always weak in the morning and very strong during the day?</p>

                    <h4><b>Reason For Being Valid</b></h4>
                    <p>Reason: The follow-up question is a “Why” question, asking specific reasons about the change of the winds during the day. Therefore, it is a valid question.</p>

                    <hr>
                    <br>

                    <h3 style="text-align: center;">Invalid Follow-up Questions Example #1</h3>
                    <h4><b>Initial Question:</b></h4>
                    <p>Why do seahorses still existed?</p>
                    <h4><b>Initial Answer:</b></h4>
                    <p>That’s not how evolution works. Evolution is survival of the fittest, not survival of the most useful. Seahorses will keep existing as long as they have food and reproduce faster than they are hunted.</p>
                    <h4><b>Follow-up Question:</b></h4>
                    <p>Ohhh, I can’t believe it. Seahorses will keep existing, really?</p>

                    <h4><b>Reason For Being Invalid</b></h4>
                    <p>Reason: “Seahorses will keep existing, really?" is in question format but is invalid, because it is not asking information but just expressing suspicious feeling.</p>

                    <hr>
                    <br>

                    <h3 style="text-align: center;">Invalid Follow-up Questions Example #2</h3>
                    <h4><b>Initial Question:</b></h4>
                    <p>Why do tapes have screen tearing and splitting, but modern media doesn’t?</p>
                    <h4><b>Initial Answer:</b></h4>
                    <p>Information on a VHS was an analog signal. To fit all of it on a tape in a linear form would end up with miles of tape. So they record the information in diagonal stripes across the tape, which is much wider than it would need to be if it just held a single track. This is then played back through a spinning head that is placed at the same angle relative to the tape as the information on it. The tape moves by the head as the head spins, reading each stripe in a fluid motion, creating the smooth video you see on playback. Pausing it stops the tape moving, but not the spinning head. So the image you see is whatever that spinning head is reading, repeated over and over. Hence the "between frames" effect.</p>
                    <h4><b>Follow-up Question:</b></h4>
                    <p>That’s right, I remember watching a Technology Connections video about how the head itself had to be skewed because of that. I remember as a kid looking inside the VCR and wondering “what is that thing, is it broken?” Now I know.</p>

                    <h4><b>Reason For Being Invalid</b></h4>
                    <p>Reason: “what is that thing, is it broken?" is just the questioner’s memory, not a question asking information in the original question or the answer.</p>
                `,
                relevant_irrelevant_example: `
                    <div style="text-align: center;"> <h3>Relevant/Irrelevant Question Guideline</h3> <h4>Our Question: </h4><p>Is the follow-up question relevant to the original question and answer?</p> <h4>Your Options:</h4> <p>A. Yes B. No</p> <p>Guideline: The follow-up question should directly relate to the topic of the original question and answer. A relevant follow-up should seek to expand upon or clarify information from the initial answer. Examples of irrelevant follow-up questions include questions that shift to unrelated topics or introduce personal anecdotes without connection to the original question or answer.</p> </div>

                    <hr>
                    <br>

                    <h3 style="text-align: center;">Relevant Follow-up Questions Example #1</h3>
                    <h4><b>Initial Question:</b></h4>
                    <p>How do airplanes stay in the air?</p>
                    <h4><b>Initial Answer:</b></h4>
                    <p>Airplanes stay in the air due to the forces of lift and thrust. Lift is generated by the shape of the wings, which forces air to move faster over the top than the bottom, creating a pressure difference that keeps the plane up. Thrust is provided by the engines, pushing the plane forward and allowing it to move through the air efficiently.</p>
                    <h4><b>Follow-up Question:</b></h4>
                    <p>What role does air pressure play in generating lift for airplanes?</p>

                    <h4><b>Reason For Being Relevant</b></h4>
                    <p>Reason: The follow-up question directly asks about the role of air pressure, which relates closely to the concept of lift described in the initial answer, making it a relevant question.</p>

                    <hr>
                    <br>

                    <h3 style="text-align: center;">Irrelevant Follow-up Questions Example #1</h3>
                    <h4><b>Initial Question:</b></h4>
                    <p>Why do people get jet lag after long flights?</p>
                    <h4><b>Initial Answer:</b></h4>
                    <p>Jet lag occurs because crossing multiple time zones disrupts the body's internal clock, or circadian rhythm. When we travel quickly across time zones, our body's schedule doesn’t match the new time, leading to feelings of tiredness, insomnia, or disorientation.</p>
                    <h4><b>Follow-up Question:</b></h4>
                    <p>Do you think the food served on airplanes contributes to feeling tired?</p>

                    <h4><b>Reason For Being Irrelevant</b></h4>
                    <p>Reason: The follow-up question about airplane food does not directly relate to jet lag or time zone disruption and instead introduces a new, unrelated topic, making it an irrelevant question.</p>
                `,
                errors_example: `
                    <div style="text-align: center;"> <h3>Error Identification Guideline</h3> <h4>Our Question: </h4><p>Does the follow-up question contain any of the following errors?</p> <h4>Your Options:</h4> <p>A. Redundant B. Context Copy C. Wrong Semantic Collocation D. Other Errors E. No Errors</p> <p>Guideline: You need to identify any language issues in the follow-up question. A redundant question repeats information already covered. Context copy occurs when the follow-up question merely restates the same content as the original. Wrong semantic collocation refers to the use of words that don't naturally fit together, either in meaning or usage. "Other Errors" can refer to any other language issues that don't fit into the categories listed above.</p> </div>

                    <hr>
                    <br>

                    <h3 style="text-align: center;">Example: Redundant Follow-up Question</h3>
                    <h4><b>Initial Question:</b></h4>
                    <p>What is the process of digestion in humans?</p>
                    <h4><b>Initial Answer:</b></h4>
                    <p>Digestion in humans begins in the mouth, where food is broken down by chewing and saliva. It continues in the stomach and small intestine, where enzymes and stomach acids further break down food into nutrients that the body can absorb.</p>
                    <h4><b>Follow-up Question:</b></h4>
                    <p>What happens when food is broken down in the stomach?</p>

                    <h4><b>Reason For Containing Error</b></h4>
                    <p>Reason: The follow-up question is redundant because the original answer already described the process of food breakdown in the stomach. The follow-up does not add new information or deepen the conversation.</p>

                    <hr>
                    <br>

                    <h3 style="text-align: center;">Example: Context Copy Follow-up Question</h3>
                    <h4><b>Initial Question:</b></h4>
                    <p>What causes climate change?</p>
                    <h4><b>Initial Answer:</b></h4>
                    <p>Climate change is caused primarily by the increase in greenhouse gases like carbon dioxide in the atmosphere, largely due to human activities such as burning fossil fuels and deforestation.</p>
                    <h4><b>Follow-up Question:</b></h4>
                    <p>Climate change is caused by greenhouse gases, right?</p>

                    <h4><b>Reason For Containing Error</b></h4>
                    <p>Reason: The follow-up question is context copy because it simply restates information already presented in the initial answer without adding any new inquiry or further exploration of the topic.</p>

                    <hr>
                    <br>

                    <h3 style="text-align: center;">Example: Wrong Semantic Collocation Follow-up Question</h3>
                    <h4><b>Initial Question:</b></h4>
                    <p>How do vaccines protect against diseases?</p>
                    <h4><b>Initial Answer:</b></h4>
                    <p>Vaccines work by stimulating the immune system to recognize and fight off specific pathogens without causing the disease itself. This is done by introducing a harmless part of the pathogen, like a protein or inactivated virus, into the body.</p>
                    <h4><b>Follow-up Question:</b></h4>
                    <p>How do vaccines strengthen the body’s protection?</p>

                    <h4><b>Reason For Containing Error</b></h4>
                    <p>Reason: The follow-up question contains a wrong semantic collocation. "Strengthen the body’s protection" is a poor fit in this context. The proper term would be "boost the immune response" or "stimulate immunity," as the question focuses on how vaccines activate the immune system, not on general "body protection."</p>
                `,
                reasoning_example: `
                    <div style="text-align: center;"> <h3>Reasoning Requirement Guideline</h3> <h4>Our Question: </h4><p>Does the follow-up question require reasoning to generate?</p> <h4>Your Options:</h4> <p>A. Yes, and very hard B. Yes, but slightly simple C. No</p> <p>Guideline: A follow-up question may require reasoning if it asks for an explanation, analysis, or prediction based on the original answer. The level of difficulty varies, where "very hard" means the reasoning requires complex analysis, "slightly simple" means it requires basic understanding or application, and "no" means no reasoning is needed at all (such as when the follow-up is simply a factual query or a direct request for clarification).</p> </div>

                    <hr>
                    <br>

                    <h3 style="text-align: center;">Example: Follow-up Question Requires Very Hard Reasoning</h3>
                    <h4><b>Initial Question:</b></h4>
                    <p>How do black holes form in space?</p>
                    <h4><b>Initial Answer:</b></h4>
                    <p>Black holes form when massive stars collapse under their own gravity after exhausting their nuclear fuel. The core becomes so dense that it creates a gravitational field strong enough to prevent even light from escaping, forming a singularity.</p>
                    <h4><b>Follow-up Question:</b></h4>
                    <p>If two black holes merge, how does the gravitational wave signal change depending on their mass and spin rates?</p>

                    <h4><b>Reason For Requiring Hard Reasoning</b></h4>
                    <p>Reason: This follow-up question requires a deep understanding of astrophysical principles and the complexities of gravitational waves. It involves predicting how specific characteristics of black holes (mass, spin) influence the wave signal during a merger. This involves advanced reasoning based on both theory and observational data, making it a very hard question to generate.</p>

                    <hr>
                    <br>

                    <h3 style="text-align: center;">Example: Follow-up Question Requires Slightly Simple Reasoning</h3>
                    <h4><b>Initial Question:</b></h4>
                    <p>Why does the moon appear larger near the horizon than when it is high in the sky?</p>
                    <h4><b>Initial Answer:</b></h4>
                    <p>The moon appears larger near the horizon due to an optical illusion called the "moon illusion." Our brains compare the moon to objects on the horizon, like trees and buildings, which makes it look bigger. In contrast, when the moon is high in the sky, there are no nearby reference points, and it appears smaller.</p>
                    <h4><b>Follow-up Question:</b></h4>
                    <p>Does the size of the moon change when it rises and sets, or is it just the illusion?</p>

                    <h4><b>Reason For Requiring Simple Reasoning</b></h4>
                    <p>Reason: This follow-up question requires basic reasoning about the nature of the moon’s size, as it asks whether the moon’s actual size changes or if the effect is purely psychological. It’s a straightforward question based on the previous explanation and requires a simple logical understanding of the optical illusion described in the answer.</p>

                    <hr>
                    <br>

                    <h3 style="text-align: center;">Example: Follow-up Question Does Not Require Reasoning</h3>
                    <h4><b>Initial Question:</b></h4>
                    <p>What is the capital of France?</p>
                    <h4><b>Initial Answer:</b></h4>
                    <p>The capital of France is Paris.</p>
                    <h4><b>Follow-up Question:</b></h4>
                    <p>Is Paris the most populous city in France?</p>

                    <h4><b>Reason For Not Requiring Reasoning</b></h4>
                    <p>Reason: This follow-up question does not require reasoning because it is a simple factual query based on the initial answer. It asks for a piece of information (whether Paris is the most populous city), which can be easily answered without complex reasoning or analysis.</p>
                `,
                new_information_example: `
                     <div style="text-align: center;"> <h3>New Information Guideline</h3> <h4>Our Question: </h4><p>Does the follow-up question reveal new information?</p> <h4>Your Options:</h4> <p>A. Yes, and a lot B. Yes, but a few C. No</p> <p>Guideline: A follow-up question may reveal new information if it introduces additional facts, details, or concepts that were not covered in the original question or answer. "Yes, and a lot" means the follow-up adds significant new details, "Yes, but a few" means it provides some new information but not much, and "No" means the follow-up does not provide any new or valuable information.</p> </div>

                    <hr>
                    <br>

                    <h3 style="text-align: center;">Example: Follow-up Question Reveals a Lot of New Information</h3>
                    <h4><b>Initial Question:</b></h4>
                    <p>What causes the northern lights?</p>
                    <h4><b>Initial Answer:</b></h4>
                    <p>The northern lights, or aurora borealis, are caused by charged particles from the sun colliding with the Earth's magnetic field. These particles excite gases in the Earth's atmosphere, causing them to emit light, which we see as colorful bands in the sky.</p>
                    <h4><b>Follow-up Question:</b></h4>
                    <p>Can the aurora borealis be seen in the southern hemisphere as well, and if so, what is it called?</p>

                    <h4><b>Reason For Revealing a Lot of New Information</b></h4>
                    <p>Reason: This follow-up question introduces the concept of the aurora australis (southern lights), which is a related but distinct phenomenon that occurs in the southern hemisphere. This adds significant new information about the northern lights and their counterpart in the southern hemisphere.</p>

                    <hr>
                    <br>

                    <h3 style="text-align: center;">Example: Follow-up Question Reveals a Few New Details</h3>
                    <h4><b>Initial Question:</b></h4>
                    <p>Why is the sky blue?</p>
                    <h4><b>Initial Answer:</b></h4>
                    <p>The sky appears blue because of Rayleigh scattering. When sunlight enters the Earth's atmosphere, shorter wavelengths like blue light scatter more easily than longer wavelengths like red, making the sky appear blue to our eyes.</p>
                    <h4><b>Follow-up Question:</b></h4>
                    <p>Does the sky appear redder during sunsets because the light has to travel through more of the atmosphere?</p>

                    <h4><b>Reason For Revealing a Few New Details</b></h4>
                    <p>Reason: This follow-up question provides a small but important detail about why the sky appears red during sunsets, relating to the angle of the sun and the greater distance the light travels through the atmosphere. This adds some new information, but it's not significantly different from the initial explanation.</p>

                    <hr>
                    <br>

                    <h3 style="text-align: center;">Example: Follow-up Question Does Not Reveal New Information</h3>
                    <h4><b>Initial Question:</b></h4>
                    <p>What is the capital of Italy?</p>
                    <h4><b>Initial Answer:</b></h4>
                    <p>The capital of Italy is Rome.</p>
                    <h4><b>Follow-up Question:</b></h4>
                    <p>Is Rome the capital city of Italy?</p>

                    <h4><b>Reason For Not Revealing New Information</b></h4>
                    <p>Reason: This follow-up question is simply a restatement of the initial question, asking the same information without providing any new facts or details.</p>
                `
            };

            // MTURk Code 
            var keys = {{ task.row_data['id'] }};
            var questions = {{ task.row_data['question'] }};
            var answers = {{ task.row_data['answer'] }};
            var followUpQuestions = {{ task.row_data['generated_follow_up'] }};

            // Test Code - comment out when in production
            // var keys = [1, 2, 3];
            // var questions = ['1', '2', '3'];
            // var answers = ['1', '2', '3'];
            // var followUpQuestions = ['1', '2', '3'];

            // Index to keep track of questions
            var questionIndex = 0;

            // number of samples
            const sampleCount = keys.length;

            // Data to Annotate (LHS of survey)
            var dataToAnnotate = [questions, answers, followUpQuestions];
            var dataToAnnotateTitles = ["Question", "Answer", "Follow-up Question"];

            // Annotation Task Questions and Options (RHS of Survey)
            var annotationQuestions = {
                1: "Is the follow-up question a valid question?",
                2: "How relevant is the follow-up question to the original question and answer?",
                3: "Does the follow-up question contain any of the following errors?",
                4: "Does generating this follow-up question require reasoning?",
                5: "Does the follow-up question contain new information for the audience?"
            };
            var annotationOptions = {
                binary: ['Yes', 'No'],
                relatedness: ['Strongly Related', 'Related', 'Slightly Related', 'Not Related'],
                errors: ['No Errors', 'Redundant (No new information added)', 'Repetitive (Follow-up is too similar to the original Question)', 'Wrong Semantic Collocation (Grammatically / Syntactically / Pragmatically Incorrect)', 'Other Errors'],
                reasoning: ['Requires <u>complex</u> amount of reasoning', 'Requires <u>moderate</u> amount of reasoning', 'Requires <u>minimal</u> amount of reasoning', '<u>Does not</u> require any reasoning'],
                newInformation: ['Introduces <u>a lot</u> of new information', 'Introduces <u>some</u>  new information', 'Introduces <u>little</u>  new information', '<u>Does not</u>  introduce any new information']
            };

            // **Generate example content
            function changeContent(example_name, button) {
                if (button) {
                    const buttons = document.querySelectorAll('.example-buttons');
                    buttons.forEach(btn => {
                        btn.classList.remove('selected');
                    });

                    button.classList.add('selected');
                }

                document.getElementById('right-section').innerHTML = examples[example_name];
            }

            // *Generate the Survey's LHS HTML
            function generateHTMLDataToAnnotate() {
                var titlesIndex = 0;

                var dataToAnnotateHTML = "";
                dataToAnnotate.forEach(function (data, index) {
                    dataToAnnotateHTML += `<p id="example_` + index + `"><b>` + dataToAnnotateTitles[titlesIndex] + `: </b>` + data[questionIndex] + `</p>`;

                    titlesIndex++;
                });
                $("#data_container").html(dataToAnnotateHTML);
            }

            // *Generate the Survey's RHS HTML
            function generateHTMLAnnotation() {
                allAnnotationQuestionsHTML = ``;
                for (let i = 0; i < sampleCount; i++) {
                    var nameBase = keys[i] + `_`;
                    var relatednessNameBase = nameBase + `relatedness`;
                    var validnessNameBase = nameBase + `validness`;
                    var relevanceNameBase = nameBase + `relevance`;
                    var errorNameBase = nameBase + `error`;
                    var reasoningNameBase = nameBase + `reasoning`;
                    var newInformationNameBase = nameBase + `newInformation`;
                    var annotationQuestionsHTML = `<div id="question-block-` + i + `" class="question-block" style="display: none;">`

                    Object.entries(annotationQuestions).forEach(([key, value]) => {
                        if (key == 1) {
                            annotationQuestionsHTML += `
                            <div class="first-question" data-question="` + key + `">
                                <h4>Question ` + key + `:</h4>
                                <div>
                                    <strong>` + value + `</strong><br/>
                                    <label><input type="radio" name="` + validnessNameBase + `" value="` + annotationOptions.binary[0] + `" required onclick=toggleRemainingQuestions(true)>` + annotationOptions.binary[0] + `</label>
                                    <br>

                                    <label><input type="radio" name="` + validnessNameBase + `" value="` + annotationOptions.binary[1] + `" onclick=toggleRemainingQuestions(false)>` + annotationOptions.binary[1] + `</label>
                                    <br>
                                </div>
                                <br>
                            </div>
                            <hr/>`;
                        }
                        if (key == 2) {
                            annotationQuestionsHTML += `
                            <div id="remaining-questions" class="remaining-questions">
                            <div class="ratings-group" data-question="` + key + `">
                                <br>
                                <h4>Question ` + key + `</h4>
                                <div>
                                    <strong>` + value + `:</strong><br/>
                                    <label><input type="radio" name="` + relevanceNameBase + `" value="` + annotationOptions.relatedness[0] + `">` + annotationOptions.relatedness[0] + `</label>
                                    <br>

                                    <label><input type="radio" name="` + relevanceNameBase + `" value="` + annotationOptions.relatedness[1] + `"> ` + annotationOptions.relatedness[1] + `</label>
                                    <br>

                                    <label><input type="radio" name="` + relevanceNameBase + `" value="` + annotationOptions.relatedness[2] + `"> ` + annotationOptions.relatedness[2] + `</label>
                                    <br>

                                    <label><input type="radio" name="` + relevanceNameBase + `" value="` + annotationOptions.relatedness[3] + `"> ` + annotationOptions.relatedness[3] + `</label>
                                    <br>
                                </div>
                                <br>
                            </div>
                            <hr/>`;
                        }
                        if (key == 3) {
                            annotationQuestionsHTML += `
                            <div class="ratings-group" data-question="` + key + `">
                                <br>
                                <h4>Question ` + key + `:</h4>
                                <div>
                                    <strong>` + value + `</strong><br/>
                                    <label><input type="checkbox" name="` + errorNameBase + `" value="` + annotationOptions.errors[0] + `">` + annotationOptions.errors[0] + `</label>
                                    <br>

                                    <label><input type="checkbox" name="` + errorNameBase + `" value="` + annotationOptions.errors[1] + `">` + annotationOptions.errors[1] + `</label>
                                    <br>

                                    <label><input type="checkbox" name="` + errorNameBase + `" value="` + annotationOptions.errors[2] + `">` + annotationOptions.errors[2] + `</label>
                                    <br>

                                    <label><input type="checkbox" name="` + errorNameBase + `" value="` + annotationOptions.errors[3] + `">` + annotationOptions.errors[3] + `</label>
                                    <br>

                                    <label><input type="checkbox" name="` + errorNameBase + `" value="` + annotationOptions.errors[4] + `">` + annotationOptions.errors[4] + `</label>
                                    <br>
                                </div>
                                <br>
                            </div>
                            <hr/>`;
                        }
                        if (key == 4) {
                            annotationQuestionsHTML += `
                            <div class="ratings-group" data-question="` + key + `">
                                <br>
                                <h4>Question ` + key + `:</h4>
                                <div>
                                    <strong>` + value + `</strong><br/>
                                    <label><input type="radio" name="` + reasoningNameBase + `" value="` + annotationOptions.reasoning[0] + `" >` + annotationOptions.reasoning[0] + `</label>
                                    <br>

                                    <label><input type="radio" name="` + reasoningNameBase + `" value="` + annotationOptions.reasoning[1] + `" > ` + annotationOptions.reasoning[1] + `</label>
                                    <br>

                                    <label><input type="radio" name="` + reasoningNameBase + `" value="` + annotationOptions.reasoning[2] + `" > ` + annotationOptions.reasoning[2] + `</label>
                                    <br>

                                    <label><input type="radio" name="` + reasoningNameBase + `" value="` + annotationOptions.reasoning[3] + `" > ` + annotationOptions.reasoning[3] + `</label>
                                    <br>

                                </div>
                                <br>
                            </div>
                            <hr/>`;
                        }
                        if (key == 5) {
                            annotationQuestionsHTML += `
                            <div class="ratings-group" data-question="` + key + `">
                                <br>
                                <h4>Question ` + key + `</h4>
                                <div>
                                    <strong>` + value + `:</strong><br/>
                                    <label><input type="radio" name="` + newInformationNameBase + `" value="` + annotationOptions.newInformation[0] + `" >` + annotationOptions.newInformation[0] + `</label>
                                    <br>

                                    <label><input type="radio" name="` + newInformationNameBase + `" value="` + annotationOptions.newInformation[1] + `" > ` + annotationOptions.newInformation[1] + `</label>
                                    <br>

                                    <label><input type="radio" name="` + newInformationNameBase + `" value="` + annotationOptions.newInformation[2] + `" > ` + annotationOptions.newInformation[2] + `</label>
                                    <br>

                                    <label><input type="radio" name="` + newInformationNameBase + `" value="` + annotationOptions.newInformation[3] + `" > ` + annotationOptions.newInformation[3] + `</label>
                                    <br>

                                </div>
                                <br>
                            </div>
                            <hr/>
                            </div>`;
                        }
                    });

                    annotationQuestionsHTML += `</div>`
                    allAnnotationQuestionsHTML += annotationQuestionsHTML
                }
                $("#annotation-questions-container").html(allAnnotationQuestionsHTML);
            }
            
            // Display remaining questions only if the user answers Yes to the Validity question
            function toggleRemainingQuestions(show) {
                const remainingQuestions = document.querySelectorAll('.remaining-questions');
                remainingQuestions.forEach(element => {
                    element.style.display = show ? 'block' : 'none';
                });
            }

            // Updates progress bar 
            function updateProgressBar() {
                var current = questionIndex + 1; // +1 to make it 1-based
                var percentage = (current / sampleCount) * 100;
                $("#progress-bar").css('width', percentage + '%');
            }

            // validates input to radio buttons before moving to the next task
            function validateCurrentStep() {
                const questionBlock = document.querySelector(`#question-block-` + questionIndex);

                if (!questionBlock) {
                    console.error('Question block not found!');
                    return false;
                }
                
                // check the value of the first (validity) question
                noRadioButton = questionBlock.querySelector('.first-question').querySelector('input[value="No"]:checked');   
                if (noRadioButton) {
                    return true
                }

                const ratingGroups = questionBlock.querySelectorAll('.ratings-group');
                let valid = true;

                ratingGroups.forEach(group => {
                    const radioSelected = group.querySelector('input[type="radio"]:checked');
                    const checkboxSelected = group.querySelector('input[type="checkbox"]:checked');

                    // Check if there's at least one selection for both input types
                    if (!radioSelected && !checkboxSelected) {
                        valid = false;
                    }
                });

                return valid
            }

            function showQuestion() {
                toggleRemainingQuestions(false)
                $(".question-block").hide();
                $(`#question-block-` + questionIndex).show();
                generateHTMLDataToAnnotate();
                updateProgressBar();
            }

            // Listeners
            // The Next button listener
            $("#next-btn").on('click', function () {
                // Ensure all toggles have been selectef for the current HIT
                if (!validateCurrentStep()) {
                    $("#validation-message").show();
                    return;
                } else {
                    $("#validation-message").hide();
                }

                // Conditionally Disable/Enable Next & Submit buttons
                if (questionIndex < sampleCount - 1) {
                    questionIndex++;
                    showQuestion();
                    $("#crowd-button").prop('disabled', true);
                    $('#next-btn').prop('disabled', false);
                } else {
                    $("#crowd-button").prop('disabled', false);
                    $('#next-btn').prop('disabled', true);
                }
            });

            $(document).ready(function () {
                changeContent('valid_invalid_example', null);
                generateHTMLAnnotation();
                showQuestion();
            });
        </script>
    </div>
</body>

</html>